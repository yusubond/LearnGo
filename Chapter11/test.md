## 测试

> 我强烈地意识到我余生的很大一部分时间都将用来寻找我程序中的错误。——莫里斯·威尔克斯《一个计算机先驱的回忆》

目录：

  * [工作原理](#工作原理)
  * [Test函数](#Test函数)

测试是 *自动化测试* 的简称，即编写简单的程序来确保程序在该测试中针对不同的输入产生预期的输出。

### 工作原理

go test子命令是Go语言包的测试驱动程序，这些包根据某些约定组织在一起。

1. `_test.go`结尾的文件是go test编译的目标，而不是go build命令编译的目标。

2. `*_test.go`文件中有三个函数需要特殊对待，即 **功能测试函数**、**基准测试函数** 和 **示例函数**。

  * 功能测试函数

    以Test前缀命名，用来检查程序逻辑的正确性，报告结果为PASS或FAIL。

  * 基准测试

    以Benchmar开头，用来测试某些操作的性能，汇报操作的平均执行时间。

  * 示例函数

    以Example开头，用来提供机器检查过的文档。

go test的工作原理：通过扫描`*_test.go`文件来寻找特殊函数，并生成一个临时的main包来调用它，然后编译、运行，并汇报结果，最后清空临时文件。

### Test函数

每一个测试文件必须导入`testing`包，功能测试函数的签名如下：

```go
func TestName(t *testing.T) {
  // ...
}
```

参数t提供汇报测试失败和日志记录的功能。

`t.Error`用来报错。`t.Errorf`可以像`Printf`函数一样提供格式化输出。

`-v`选项可以输出每个测试用例的名称和执行时间

`-run`选项可以通过正则表达式的方式，输出测试函数相匹配的函数。

```bash
$ go test -v
$ go test -v -run="French|Canal"
```
