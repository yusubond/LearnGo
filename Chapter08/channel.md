## 通道

如果说goroutine是Go程序并发的执行体，那么通道就是它们之间的连接。**通道是可以让一个goroutine发送特定值到另一个goroutine的通信机制**。

每一个通道是一个具体类型的导管，就做通道的 *元素类型*。一个有int类型元素的通道，写作`chan int`，使用内置函数<p style="color:#FF0000">make</p>可以创建一个通道。

```go
ch := make(chan int)      // ch的类型为"chan int"
```

**通道是一个使用`make`函数创建的数据结构的引用**，这一点与map类似。*当复制或作为参数传递到一个函数时，复制的是引用，因此调用者和被调用者都引用同一份数据结构*。通道的零值是nil。

同种类型的通道可以使用`==`符号进行比较，当两者都是同一个通道数据的引用时，返回结果为`true`。

通道有两个主要操作：发送(send)和接收(receive)，统称为通信。send语句从一个goroutine传输一个值到另一个执行接收表达式的goroutine。两个操作都是用`<-`操作符。

发送语句中，通道和值分别放在`<-`的左右两边；接收语句中，`<-`放在通道操作数前面。

```go
ch <- x         // 发送x到通道ch
rx = <- ch      // 从通道ch中接收一个值，并赋值给rx
<- ch           // 接收语句，丢弃结果
```

通道还有第三个操作：关闭(close)，它设置一个标志位来指示当前已经发送完毕，后面没有值了；关闭后的发送操作将导致宕机。其次，在一个已经关闭的通道上进行接收操作，将获取所有已经发送的值，直到通道为空；这时任何接收操作会立即完成，同时获取一个通道元素类型对应的零值。

内置函数`close`可以关闭通道。

```go
close(ch)
```
